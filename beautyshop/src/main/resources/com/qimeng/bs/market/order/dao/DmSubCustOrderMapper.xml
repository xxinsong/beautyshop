<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.qimeng.bs.market.order.dao.DmSubCustOrderMapper">
  <resultMap id="BaseResultMap" type="com.qimeng.bs.market.order.bean.DmSubCustOrder">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Dec 23 15:00:56 CST 2013.
    -->
    <id column="SUB_ORDER_ID" jdbcType="INTEGER" property="subOrderId" />
    <result column="PLAN_ID" jdbcType="INTEGER" property="planId" />
    <result column="ORDER_ID" jdbcType="INTEGER" property="orderId" />
    <result column="GOODS_INST_ID" jdbcType="INTEGER" property="goodsInstId" />
    <result column="GOODS_NAME" jdbcType="VARCHAR" property="goodsName" />
    <result column="ITEM_NO" jdbcType="INTEGER" property="itemNo" />
    <result column="PRICE" jdbcType="REAL" property="price" />
    <result column="CREATE_DATE" jdbcType="TIMESTAMP" property="createDate" />
    <result column="COMMENTATED" jdbcType="CHAR" property="commentated" />
    <result column="STATE" jdbcType="VARCHAR" property="state" />
    <result column="NOTES" jdbcType="VARCHAR" property="notes" />
    <result column="OPER_DATE" jdbcType="TIMESTAMP" property="operDate" />
    <result column="OPER_STAFF_NO" jdbcType="VARCHAR" property="operStaffNo" />
    <result column="OPER_NOTES" jdbcType="VARCHAR" property="operNotes" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Dec 23 15:00:56 CST 2013.
    -->
    SUB_ORDER_ID, PLAN_ID, ORDER_ID, GOODS_INST_ID, GOODS_NAME, ITEM_NO, PRICE, CREATE_DATE,
    COMMENTATED, STATE, NOTES, OPER_DATE, OPER_STAFF_NO, OPER_NOTES
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Dec 23 15:00:56 CST 2013.
    -->
    select 
    <include refid="Base_Column_List" />
    from dm_sub_cust_order
    where SUB_ORDER_ID = #{subOrderId,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Dec 23 15:00:56 CST 2013.
    -->
    delete from dm_sub_cust_order
    where SUB_ORDER_ID = #{subOrderId,jdbcType=INTEGER}
  </delete>
    <delete id="deleteSubOrderByOrderId" parameterType="java.lang.Integer">
        delete from dm_sub_cust_order
        where ORDER_ID = #{orderId,jdbcType=INTEGER}
    </delete>
    <insert id="insert" parameterType="com.qimeng.bs.market.order.bean.DmSubCustOrder">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Dec 23 15:00:56 CST 2013.
    -->
    insert into dm_sub_cust_order (SUB_ORDER_ID, PLAN_ID, ORDER_ID, 
      GOODS_INST_ID, GOODS_NAME, ITEM_NO,
      PRICE, CREATE_DATE, COMMENTATED, 
      STATE, NOTES, OPER_DATE, 
      OPER_STAFF_NO, OPER_NOTES)
    values (#{subOrderId,jdbcType=INTEGER}, #{planId,jdbcType=INTEGER}, #{orderId,jdbcType=INTEGER}, 
      #{goodsInstId,jdbcType=INTEGER}, #{goodsName,jdbcType=VARCHAR}, #{itemNo,jdbcType=INTEGER},
      #{price,jdbcType=REAL}, #{createDate,jdbcType=TIMESTAMP}, #{commentated,jdbcType=CHAR}, 
      #{state,jdbcType=VARCHAR}, #{notes,jdbcType=VARCHAR}, #{operDate,jdbcType=TIMESTAMP}, 
      #{operStaffNo,jdbcType=VARCHAR}, #{operNotes,jdbcType=VARCHAR})
  </insert>
  <insert id="insertSelective" parameterType="com.qimeng.bs.market.order.bean.DmSubCustOrder">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Dec 23 15:00:56 CST 2013.
    -->
    insert into dm_sub_cust_order
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="subOrderId != null">
        SUB_ORDER_ID,
      </if>
      <if test="planId != null">
        PLAN_ID,
      </if>
      <if test="orderId != null">
        ORDER_ID,
      </if>
      <if test="goodsInstId != null">
        GOODS_INST_ID,
      </if>
      <if test="goodsName != null">
        GOODS_NAME,
      </if>
      <if test="itemNo != null">
        ITEM_NO,
      </if>
      <if test="price != null">
        PRICE,
      </if>
      <if test="createDate != null">
        CREATE_DATE,
      </if>
      <if test="commentated != null">
        COMMENTATED,
      </if>
      <if test="state != null">
        STATE,
      </if>
      <if test="notes != null">
        NOTES,
      </if>
      <if test="operDate != null">
        OPER_DATE,
      </if>
      <if test="operStaffNo != null">
        OPER_STAFF_NO,
      </if>
      <if test="operNotes != null">
        OPER_NOTES,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="subOrderId != null">
        #{subOrderId,jdbcType=INTEGER},
      </if>
      <if test="planId != null">
        #{planId,jdbcType=INTEGER},
      </if>
      <if test="orderId != null">
        #{orderId,jdbcType=INTEGER},
      </if>
      <if test="goodsInstId != null">
        #{goodsInstId,jdbcType=INTEGER},
      </if>
      <if test="goodsName != null">
        #{goodsName,jdbcType=VARCHAR},
      </if>
      <if test="itemNo != null">
        #{itemNo,jdbcType=INTEGER},
      </if>
      <if test="price != null">
        #{price,jdbcType=REAL},
      </if>
      <if test="createDate != null">
        #{createDate,jdbcType=TIMESTAMP},
      </if>
      <if test="commentated != null">
        #{commentated,jdbcType=CHAR},
      </if>
      <if test="state != null">
        #{state,jdbcType=VARCHAR},
      </if>
      <if test="notes != null">
        #{notes,jdbcType=VARCHAR},
      </if>
      <if test="operDate != null">
        #{operDate,jdbcType=TIMESTAMP},
      </if>
      <if test="operStaffNo != null">
        #{operStaffNo,jdbcType=VARCHAR},
      </if>
      <if test="operNotes != null">
        #{operNotes,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.qimeng.bs.market.order.bean.DmSubCustOrder">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Dec 23 15:00:56 CST 2013.
    -->
    update dm_sub_cust_order
    <set>
      <if test="planId != null">
        PLAN_ID = #{planId,jdbcType=INTEGER},
      </if>
      <if test="orderId != null">
        ORDER_ID = #{orderId,jdbcType=INTEGER},
      </if>
      <if test="goodsInstId != null">
        GOODS_INST_ID = #{goodsInstId,jdbcType=INTEGER},
      </if>
      <if test="goodsName != null">
        GOODS_NAME = #{goodsName,jdbcType=VARCHAR},
      </if>
      <if test="itemNo != null">
        ITEM_NO = #{itemNo,jdbcType=INTEGER},
      </if>
      <if test="price != null">
        PRICE = #{price,jdbcType=REAL},
      </if>
      <if test="createDate != null">
        CREATE_DATE = #{createDate,jdbcType=TIMESTAMP},
      </if>
      <if test="commentated != null">
        COMMENTATED = #{commentated,jdbcType=CHAR},
      </if>
      <if test="state != null">
        STATE = #{state,jdbcType=VARCHAR},
      </if>
      <if test="notes != null">
        NOTES = #{notes,jdbcType=VARCHAR},
      </if>
      <if test="operDate != null">
        OPER_DATE = #{operDate,jdbcType=TIMESTAMP},
      </if>
      <if test="operStaffNo != null">
        OPER_STAFF_NO = #{operStaffNo,jdbcType=VARCHAR},
      </if>
      <if test="operNotes != null">
        OPER_NOTES = #{operNotes,jdbcType=VARCHAR},
      </if>
    </set>
    where SUB_ORDER_ID = #{subOrderId,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.qimeng.bs.market.order.bean.DmSubCustOrder">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Mon Dec 23 15:00:56 CST 2013.
    -->
    update dm_sub_cust_order
    set PLAN_ID = #{planId,jdbcType=INTEGER},
      ORDER_ID = #{orderId,jdbcType=INTEGER},
      GOODS_INST_ID = #{goodsInstId,jdbcType=INTEGER},
      GOODS_NAME = #{goodsName,jdbcType=VARCHAR},
      ITEM_NO = #{itemNo,jdbcType=INTEGER},
      PRICE = #{price,jdbcType=REAL},
      CREATE_DATE = #{createDate,jdbcType=TIMESTAMP},
      COMMENTATED = #{commentated,jdbcType=CHAR},
      STATE = #{state,jdbcType=VARCHAR},
      NOTES = #{notes,jdbcType=VARCHAR},
      OPER_DATE = #{operDate,jdbcType=TIMESTAMP},
      OPER_STAFF_NO = #{operStaffNo,jdbcType=VARCHAR},
      OPER_NOTES = #{operNotes,jdbcType=VARCHAR}
    where SUB_ORDER_ID = #{subOrderId,jdbcType=INTEGER}
  </update>
    <update id="updateOrderState">
        update dm_sub_cust_order
        set STATE = #{state,jdbcType=VARCHAR}
        where ORDER_ID = #{orderId,jdbcType=INTEGER}
    </update>

    <!--
        关联查询出GOODS_ID
    -->
    <resultMap id="SubOrderResultMap" type="com.qimeng.bs.market.order.bean.DmSubCustOrder">
        <id column="SUB_ORDER_ID" jdbcType="INTEGER" property="subOrderId" />
        <result column="PLAN_ID" jdbcType="INTEGER" property="planId" />
        <result column="ORDER_ID" jdbcType="INTEGER" property="orderId" />
        <result column="GOODS_INST_ID" jdbcType="INTEGER" property="goodsInstId" />
        <result column="GOODS_NAME" jdbcType="VARCHAR" property="goodsName" />
        <result column="ITEM_NO" jdbcType="INTEGER" property="itemNo" />
        <result column="PRICE" jdbcType="DECIMAL" property="price" />
        <result column="CREATE_DATE" jdbcType="TIMESTAMP" property="createDate" />
        <result column="COMMENTATED" jdbcType="CHAR" property="commentated" />
        <result column="STATE" jdbcType="VARCHAR" property="state" />
        <result column="NOTES" jdbcType="VARCHAR" property="notes" />
        <result column="OPER_DATE" jdbcType="TIMESTAMP" property="operDate" />
        <result column="OPER_STAFF_NO" jdbcType="VARCHAR" property="operStaffNo" />
        <result column="OPER_NOTES" jdbcType="VARCHAR" property="operNotes" />
        <result column="GOODS_ID" jdbcType="INTEGER" property="goodsId" />
        <result column="GOODS_NO" jdbcType="VARCHAR" property="goodsNo" />
        <result column="IMAGE_URI" jdbcType="INTEGER" property="goodsImage" />
    </resultMap>
    <select id="selectSubOrderByOrderId" parameterType="java.lang.Integer" resultMap="SubOrderResultMap">
        select
          a.SUB_ORDER_ID,
          a.PLAN_ID,
          a.ORDER_ID,
          a.GOODS_INST_ID,
          a.GOODS_NAME,
          a.ITEM_NO,
          a.PRICE,
          a.CREATE_DATE,
          a.COMMENTATED,
          a.STATE,
          a.NOTES,
          a.OPER_DATE,
          a.OPER_STAFF_NO,
          a.OPER_NOTES,
          b.GOODS_ID,
          C.GOODS_NO,
          C.IMAGE_URI
        from dm_sub_cust_order a left JOIN dm_goods_inst b on a.goods_inst_id = b.inst_id
              left join dm_goods c on b.goods_id = c.goods_id
        where a.ORDER_ID = #{orderId,jdbcType=INTEGER}
        order by a.create_date desc
    </select>
    <select id="selectSubOrderByOrderIdPage" parameterType="Page" resultMap="SubOrderResultMap">
        select
          a.SUB_ORDER_ID,
          a.PLAN_ID,
          a.ORDER_ID,
          a.GOODS_INST_ID,
          a.GOODS_NAME,
          a.ITEM_NO,
          a.PRICE,
          a.CREATE_DATE,
          a.COMMENTATED,
          a.STATE,
          b.GOODS_ID
        from dm_sub_cust_order a left JOIN dm_goods_inst b on a.goods_inst_id = b.inst_id
        where a.ORDER_ID = #{orderId,jdbcType=INTEGER}
        order by a.create_date desc
    </select>
    <select id="selectCommentOrder" resultMap="BaseResultMap">
        select
          a.SUB_ORDER_ID,
          a.PLAN_ID,
          a.ORDER_ID,
          a.GOODS_INST_ID,
          a.GOODS_NAME,
          a.ITEM_NO,
          a.PRICE,
          a.CREATE_DATE,
          a.COMMENTATED,
          a.STATE
        from dm_sub_cust_order a inner join dm_cust_order b on a.order_id = b.order_id
        where SUB_ORDER_ID = #{subOrderId,jdbcType=INTEGER}
          and b.merchant_id = #{merchantId,jdbcType=INTEGER}
    </select>
    <select id="querySubOrderByPage" resultType="com.qimeng.bs.market.order.bean.DmSubCustOrder">

    </select>
</mapper>