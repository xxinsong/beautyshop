<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.qimeng.bs.market.goods.dao.DmShoppingCartMapper" >
  <resultMap id="BaseResultMap" type="com.qimeng.bs.market.goods.bean.DmShoppingCart" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Dec 19 16:21:31 CST 2013.
    -->
    <id column="ID" property="id" jdbcType="INTEGER" />
    <result column="GOODS_INST_ID" property="goodsInstId" jdbcType="INTEGER" />
    <result column="MERCHANT_ID" property="merchantId" jdbcType="INTEGER" />
    <result column="ORDER_ID" property="orderId" jdbcType="INTEGER" />
    <result column="GOODS_ITEM_NO" property="goodsItemNo" jdbcType="INTEGER" />
    <result column="CTEATE_TIME" property="cteateTime" jdbcType="TIMESTAMP" />
    <result column="STATE" property="state" jdbcType="VARCHAR" />
  </resultMap>

    <resultMap id="GoodsInstMap" type="com.qimeng.bs.market.goods.bean.DmGoodsInst">
        <id column="INST_ID" jdbcType="INTEGER" property="instId" />
        <result column="MERCHANT_ID" jdbcType="INTEGER" property="merchantId" />
        <result column="GOODS_ID" jdbcType="INTEGER" property="goodsId" />
        <result column="PLAN_ID" jdbcType="INTEGER" property="planId" />
        <result column="GOODS_NAME" jdbcType="VARCHAR" property="goodsName" />
        <result column="GOODS_TYPE" jdbcType="VARCHAR" property="goodsType" />
        <result column="DATA_START_TIME" jdbcType="TIMESTAMP" property="dataStartTime" />
        <result column="DATA_END_TIME" jdbcType="TIMESTAMP" property="dataEndTime" />
        <result column="MAX_NUM" jdbcType="INTEGER" property="maxNum" />
        <result column="EFF_DATE" jdbcType="TIMESTAMP" property="effDate" />
        <result column="EXP_DATE" jdbcType="TIMESTAMP" property="expDate" />
        <result column="STATE" jdbcType="VARCHAR" property="state" />
        <association property="dmGoodsPlan" resultMap="GoodsPlanMap"/>
    </resultMap>
    <resultMap id="GoodsPlanMap" type="com.qimeng.bs.admin.goods.bean.DmGoodsPlan" >
        <id column="PLAN_ID" property="planId" jdbcType="INTEGER" />
        <result column="GOODS_ID" property="goodsId" jdbcType="INTEGER" />
        <result column="PLAN_NAME" property="planName" jdbcType="VARCHAR" />
        <result column="PLAN_INTRO" property="planIntro" jdbcType="VARCHAR" />
        <result column="PLAN_PRICE" property="planPrice" jdbcType="REAL" />
        <result column="PLAN_SHOW_PRICE" property="planShowPrice" jdbcType="REAL" />
        <result column="PLAN_DESC" property="planDesc" jdbcType="VARCHAR" />
        <result column="EFF_DATE" property="effDate" jdbcType="TIMESTAMP" />
        <result column="EXP_DATE" property="expDate" jdbcType="TIMESTAMP" />
        <result column="STATE_DATE" property="stateDate" jdbcType="TIMESTAMP" />
        <result column="OPER_STAFF_ID" property="operStaffId" jdbcType="VARCHAR" />
        <result column="OPER_STAFF_NAME" property="operStaffName" jdbcType="VARCHAR" />
        <result column="PLAN_TYPE" property="planType" jdbcType="VARCHAR" />
        <result column="STATE" property="state" jdbcType="VARCHAR" />
    </resultMap>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Dec 19 16:21:31 CST 2013.
    -->
    ID, GOODS_INST_ID, MERCHANT_ID, ORDER_ID, GOODS_ITEM_NO, CTEATE_TIME, STATE
  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Dec 19 16:21:31 CST 2013.
    -->
    select 
    <include refid="Base_Column_List" />
    from dm_shopping_cart
    where ID = #{id,jdbcType=INTEGER}
  </select>
    <select id="selectGoodsInstInCart" resultMap="GoodsInstMap" parameterType="java.lang.Integer">
      select
        A.INST_ID,
        A.MERCHANT_ID,
        A.GOODS_ID,
        A.PLAN_ID,
        A.GOODS_NAME,
        A.GOODS_TYPE,
        A.DATA_START_TIME,
        A.DATA_END_TIME,
        A.MAX_NUM,
        A.EFF_DATE,
        A.EXP_DATE,
        A.STATE,
        C.PLAN_NAME,
        C.PLAN_INTRO,
        C.PLAN_PRICE,
        C.PLAN_SHOW_PRICE
      from dm_goods_inst a inner join dm_shopping_cart b on a.inst_id = b.goods_inst_id
        LEFT JOIN DM_GOODS_PLAN C ON A.PLAN_ID = C.PLAN_ID
      where b.merchant_id = #{merchantId,jdbcType=INTEGER}
      ORDER BY ORDER_ID
    </select>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Dec 19 16:21:31 CST 2013.
    -->
    delete from dm_shopping_cart
    where ID = #{id,jdbcType=INTEGER}
  </delete>
    <delete id="removeGoodsInCart" parameterType="java.lang.Integer">
        delete from dm_shopping_cart
        where goods_inst_id = #{goodsInstId,jdbcType=INTEGER}
    </delete>
    <delete id="batchRemoveGoodsInCart" parameterType="java.util.List">
        delete from dm_shopping_cart
        where goods_inst_id in
         <foreach item="item" collection="list" index="index" open="(" separator="," close=")">
            #{item,jdbcType=INTEGER}
         </foreach>
    </delete>
    <delete id="removeGoodsInCartByMerchantId" parameterType="java.lang.Integer">
        delete from dm_shopping_cart
        where merchant_id = #{merchantId,jdbcType=INTEGER}
    </delete>
  <insert id="insert" parameterType="com.qimeng.bs.market.goods.bean.DmShoppingCart" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Dec 19 16:21:31 CST 2013.
    -->
    insert into dm_shopping_cart (ID, GOODS_INST_ID, MERCHANT_ID, 
      ORDER_ID, GOODS_ITEM_NO, CTEATE_TIME, 
      STATE)
    values (#{id,jdbcType=INTEGER}, #{goodsInstId,jdbcType=INTEGER}, #{merchantId,jdbcType=INTEGER}, 
      #{orderId,jdbcType=INTEGER}, #{goodsItemNo,jdbcType=INTEGER}, #{cteateTime,jdbcType=TIMESTAMP}, 
      #{state,jdbcType=VARCHAR})
  </insert>
  <insert id="insertSelective" parameterType="com.qimeng.bs.market.goods.bean.DmShoppingCart" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Dec 19 16:21:31 CST 2013.
    -->
    insert into dm_shopping_cart
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        ID,
      </if>
      <if test="goodsInstId != null" >
        GOODS_INST_ID,
      </if>
      <if test="merchantId != null" >
        MERCHANT_ID,
      </if>
      <if test="orderId != null" >
        ORDER_ID,
      </if>
      <if test="goodsItemNo != null" >
        GOODS_ITEM_NO,
      </if>
      <if test="cteateTime != null" >
        CTEATE_TIME,
      </if>
      <if test="state != null" >
        STATE,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="id != null" >
        #{id,jdbcType=INTEGER},
      </if>
      <if test="goodsInstId != null" >
        #{goodsInstId,jdbcType=INTEGER},
      </if>
      <if test="merchantId != null" >
        #{merchantId,jdbcType=INTEGER},
      </if>
      <if test="orderId != null" >
        #{orderId,jdbcType=INTEGER},
      </if>
      <if test="goodsItemNo != null" >
        #{goodsItemNo,jdbcType=INTEGER},
      </if>
      <if test="cteateTime != null" >
        #{cteateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="state != null" >
        #{state,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.qimeng.bs.market.goods.bean.DmShoppingCart" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Dec 19 16:21:31 CST 2013.
    -->
    update dm_shopping_cart
    <set >
      <if test="goodsInstId != null" >
        GOODS_INST_ID = #{goodsInstId,jdbcType=INTEGER},
      </if>
      <if test="merchantId != null" >
        MERCHANT_ID = #{merchantId,jdbcType=INTEGER},
      </if>
      <if test="orderId != null" >
        ORDER_ID = #{orderId,jdbcType=INTEGER},
      </if>
      <if test="goodsItemNo != null" >
        GOODS_ITEM_NO = #{goodsItemNo,jdbcType=INTEGER},
      </if>
      <if test="cteateTime != null" >
        CTEATE_TIME = #{cteateTime,jdbcType=TIMESTAMP},
      </if>
      <if test="state != null" >
        STATE = #{state,jdbcType=VARCHAR},
      </if>
    </set>
    where ID = #{id,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.qimeng.bs.market.goods.bean.DmShoppingCart" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Dec 19 16:21:31 CST 2013.
    -->
    update dm_shopping_cart
    set GOODS_INST_ID = #{goodsInstId,jdbcType=INTEGER},
      MERCHANT_ID = #{merchantId,jdbcType=INTEGER},
      ORDER_ID = #{orderId,jdbcType=INTEGER},
      GOODS_ITEM_NO = #{goodsItemNo,jdbcType=INTEGER},
      CTEATE_TIME = #{cteateTime,jdbcType=TIMESTAMP},
      STATE = #{state,jdbcType=VARCHAR}
    where ID = #{id,jdbcType=INTEGER}
  </update>
</mapper>