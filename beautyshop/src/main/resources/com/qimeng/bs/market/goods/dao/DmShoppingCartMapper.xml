<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.qimeng.bs.market.goods.dao.DmShoppingCartMapper">
    <resultMap id="BaseResultMap" type="com.qimeng.bs.market.goods.bean.DmShoppingCartItem">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Sun Jan 05 16:51:30 CST 2014.
        -->
        <id column="ID" jdbcType="INTEGER" property="id"/>
        <result column="GOODS_ID" jdbcType="INTEGER" property="goodsId"/>
        <result column="MERCHANT_ID" jdbcType="INTEGER" property="merchantId"/>
        <result column="ORDER_ID" jdbcType="INTEGER" property="orderId"/>
        <result column="ITEM_NO" jdbcType="INTEGER" property="itemNo"/>
        <result column="CTEATE_TIME" jdbcType="TIMESTAMP" property="cteateTime"/>
        <result column="STATE" jdbcType="VARCHAR" property="state"/>
    </resultMap>
    <resultMap id="ShoppingCartItemMap" type="com.qimeng.bs.market.goods.bean.DmShoppingCartItem">
        <id column="ID" jdbcType="INTEGER" property="id"/>
        <result column="GOODS_ID" jdbcType="INTEGER" property="goodsId"/>
        <result column="MERCHANT_ID" jdbcType="INTEGER" property="merchantId"/>
        <result column="ORDER_ID" jdbcType="INTEGER" property="orderId"/>
        <result column="ITEM_NO" jdbcType="INTEGER" property="itemNo"/>
        <result column="CTEATE_TIME" jdbcType="TIMESTAMP" property="cteateTime"/>
        <result column="STATE" jdbcType="VARCHAR" property="state"/>
        <result column="GOODS_NO" jdbcType="VARCHAR" property="goodsNo"/>
        <result column="GOODS_NAME" jdbcType="VARCHAR" property="goodsName"/>
        <result column="PRICE" jdbcType="FLOAT" property="price"/>
        <result column="IMAGE_URI" jdbcType="VARCHAR" property="goodsImage"/>
    </resultMap>
    <sql id="Base_Column_List">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Sun Jan 05 16:51:30 CST 2014.
        -->
        ID, GOODS_ID, MERCHANT_ID, ORDER_ID, ITEM_NO, CTEATE_TIME, STATE
    </sql>
    <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Sun Jan 05 16:51:30 CST 2014.
        -->
        select
        <include refid="Base_Column_List"/>
        from dm_shopping_cart
        where ID = #{id,jdbcType=INTEGER}
    </select>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Sun Jan 05 16:51:30 CST 2014.
        -->
        delete from dm_shopping_cart
        where ID = #{id,jdbcType=INTEGER}
    </delete>
    <insert id="insert" parameterType="com.qimeng.bs.market.goods.bean.DmShoppingCartItem">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Sun Jan 05 16:51:30 CST 2014.
        -->
        insert into dm_shopping_cart (ID, GOODS_ID, MERCHANT_ID,
        ORDER_ID, ITEM_NO, CTEATE_TIME,
        STATE)
        values (#{id,jdbcType=INTEGER}, #{goodsId,jdbcType=INTEGER}, #{merchantId,jdbcType=INTEGER},
        #{orderId,jdbcType=INTEGER}, #{itemNo,jdbcType=INTEGER}, #{cteateTime,jdbcType=TIMESTAMP},
        #{state,jdbcType=VARCHAR})
    </insert>
    <insert id="insertSelective" parameterType="com.qimeng.bs.market.goods.bean.DmShoppingCartItem">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Sun Jan 05 16:51:30 CST 2014.
        -->
        insert into dm_shopping_cart
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="id != null">
                ID,
            </if>
            <if test="goodsId != null">
                GOODS_ID,
            </if>
            <if test="merchantId != null">
                MERCHANT_ID,
            </if>
            <if test="orderId != null">
                ORDER_ID,
            </if>
            <if test="itemNo != null">
                ITEM_NO,
            </if>
            <if test="cteateTime != null">
                CTEATE_TIME,
            </if>
            <if test="state != null">
                STATE,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="id != null">
                #{id,jdbcType=INTEGER},
            </if>
            <if test="goodsId != null">
                #{goodsId,jdbcType=INTEGER},
            </if>
            <if test="merchantId != null">
                #{merchantId,jdbcType=INTEGER},
            </if>
            <if test="orderId != null">
                #{orderId,jdbcType=INTEGER},
            </if>
            <if test="itemNo != null">
                #{itemNo,jdbcType=INTEGER},
            </if>
            <if test="cteateTime != null">
                #{cteateTime,jdbcType=TIMESTAMP},
            </if>
            <if test="state != null">
                #{state,jdbcType=VARCHAR},
            </if>
        </trim>
    </insert>
    <update id="updateByPrimaryKeySelective" parameterType="com.qimeng.bs.market.goods.bean.DmShoppingCartItem">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Sun Jan 05 16:51:30 CST 2014.
        -->
        update dm_shopping_cart
        <set>
            <if test="goodsId != null">
                GOODS_ID = #{goodsId,jdbcType=INTEGER},
            </if>
            <if test="merchantId != null">
                MERCHANT_ID = #{merchantId,jdbcType=INTEGER},
            </if>
            <if test="orderId != null">
                ORDER_ID = #{orderId,jdbcType=INTEGER},
            </if>
            <if test="itemNo != null">
                ITEM_NO = #{itemNo,jdbcType=INTEGER},
            </if>
            <if test="cteateTime != null">
                CTEATE_TIME = #{cteateTime,jdbcType=TIMESTAMP},
            </if>
            <if test="state != null">
                STATE = #{state,jdbcType=VARCHAR},
            </if>
        </set>
        where ID = #{id,jdbcType=INTEGER}
    </update>
    <update id="updateByPrimaryKey" parameterType="com.qimeng.bs.market.goods.bean.DmShoppingCartItem">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Sun Jan 05 16:51:30 CST 2014.
        -->
        update dm_shopping_cart
        set GOODS_ID = #{goodsId,jdbcType=INTEGER},
        MERCHANT_ID = #{merchantId,jdbcType=INTEGER},
        ORDER_ID = #{orderId,jdbcType=INTEGER},
        ITEM_NO = #{itemNo,jdbcType=INTEGER},
        CTEATE_TIME = #{cteateTime,jdbcType=TIMESTAMP},
        STATE = #{state,jdbcType=VARCHAR}
        where ID = #{id,jdbcType=INTEGER}
    </update>


    <resultMap id="GoodsPlanMap" type="com.qimeng.bs.admin.goods.bean.DmGoodsPlan">
        <id column="PLAN_ID" jdbcType="INTEGER" property="planId"/>
        <result column="GOODS_ID" jdbcType="INTEGER" property="goodsId"/>
        <result column="PLAN_NAME" jdbcType="VARCHAR" property="planName"/>
        <result column="PLAN_INTRO" jdbcType="VARCHAR" property="planIntro"/>
        <result column="PLAN_PRICE" jdbcType="REAL" property="planPrice"/>
        <result column="PLAN_SHOW_PRICE" jdbcType="REAL" property="planShowPrice"/>
        <result column="PLAN_DESC" jdbcType="VARCHAR" property="planDesc"/>
        <result column="EFF_DATE" jdbcType="TIMESTAMP" property="effDate"/>
        <result column="EXP_DATE" jdbcType="TIMESTAMP" property="expDate"/>
        <result column="STATE_DATE" jdbcType="TIMESTAMP" property="stateDate"/>
        <result column="OPER_STAFF_ID" jdbcType="VARCHAR" property="operStaffId"/>
        <result column="OPER_STAFF_NAME" jdbcType="VARCHAR" property="operStaffName"/>
        <result column="PLAN_TYPE" jdbcType="VARCHAR" property="planType"/>
        <result column="STATE" jdbcType="VARCHAR" property="state"/>
    </resultMap>
    <!--<select id="selectGoodsInstInCart" parameterType="java.lang.Integer" resultMap="GoodsInstMap">
      select
        A.INST_ID,
        A.MERCHANT_ID,
        A.GOODS_ID,
        A.PLAN_ID,
        A.GOODS_NAME,
        A.GOODS_TYPE,
        A.DATA_START_TIME,
        A.DATA_END_TIME,
        A.MAX_NUM,
        A.EFF_DATE,
        A.EXP_DATE,
        A.STATE,
        C.PLAN_NAME,
        C.PLAN_INTRO,
        C.PLAN_PRICE,
        C.PLAN_SHOW_PRICE
      from dm_goods_inst a inner join dm_shopping_cart b on a.inst_id = b.goods_inst_id
        LEFT JOIN DM_GOODS_PLAN C ON A.PLAN_ID = C.PLAN_ID
      where b.merchant_id = #{merchantId,jdbcType=INTEGER}
      ORDER BY ORDER_ID
    </select>-->
    <select id="selectShoppingCartItemsByMerchantId" parameterType="java.lang.Integer" resultMap="ShoppingCartItemMap">
        select
         A.ID,
         A.GOODS_ID,
         A.MERCHANT_ID,
         A.ORDER_ID,
         A.ITEM_NO,
         A.CTEATE_TIME,
         A.STATE,
         B.GOODS_NO,
         B.GOODS_NAME,
         B.PRICE,
         B.IMAGE_URI
       FROM DM_SHOPPING_CART A inner join DM_GOODS B on A.GOODS_ID = B.GOODS_ID
       WHERE A.MERCHANT_ID = #{merchantId}
    </select>
    <delete id="removeGoodsInCart" parameterType="java.lang.Integer">
        delete from dm_shopping_cart
        where goods_inst_id = #{goodsId,jdbcType=INTEGER}
    </delete>
    <delete id="batchRemoveGoodsInCart" parameterType="java.util.List">
        delete from dm_shopping_cart
        where goods_id in
        <foreach close=")" collection="list" index="index" item="item" open="(" separator=",">
            #{item,jdbcType=INTEGER}
        </foreach>
    </delete>
    <delete id="removeGoodsInCartByMerchantId" parameterType="java.lang.Integer">
        delete from dm_shopping_cart
        where merchant_id = #{merchantId,jdbcType=INTEGER}
    </delete>
</mapper>